KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK============================ 0 = DELAY ROUTINE             = 1 = SET DL EQUAL TO NUMBER OF = 61 = SECONDS DELAY             = Z1 ============================= g1T(678) ~1H60:  T1  H50 1STI:E DLH 1 (TIS)  E  52980 1K .S$"PRESS YOUR BACKSPACE KEY NOW:": 50340 / 51340:  GET THE INPUT INTO C Q/" C8  S$"LOOKS LIKE AN ASCII SYSTEM":TT2: 50730: 50340:  50730: /, C127  S$"LOOKS LIKE A UNIX OR VT100 SYSTEM":TT3: 50730: 50340:  50730: /6 C2K ============================= , = PRINT 6551 REGISTER STATUS= -( ============================= <-2 "======================" ^-< "=DATA REGISTER:    ";(DR) -F "=STATUS RESGISTER: ";(SR) -P "=COMMAND REGISTER: ";(CM) -Z "=CONTROL RKKKKK    $"LOOKS LIKE A COMMODORE SYSTEM":TT1: 50730: 50340:  50730: A0@S$"ARE YOU SURE YOU HIT YOUR BACKSPACE KEY?": 50730: 50340:  50730 `0JTRTR1: TR  4   52750 0TS$"TOO MANY TRIES!  LOGGING OUT!": 50730: 50340: 50730:TT0: 0 =K0  S$"LOOKS LIKE A COMMODORE SYSTEM":TT1: 50730: 50340:  50730: A0@S$"ARE YOU SURE YOU HIT YOUR BACKSPACE KEY?": 50730: 50340:  50730 `0JTRTR1: TR  4   52750 0TS$"TOO MANY TRIES!  LOGGING OUT!": 50730: 50340: 50730:TT0: 0 =KEGISTER: ";(CR) -_ 52450 -d "=CARRIER STATUS:   ";CD .n "======================" .x 8. ============================= \. = GET BACKSPACE/DEL KEY CODE= . ============================= . PRINT "WAITING FOR BACKSPACE KEY." .TR0KKK
VE LINE SUBROUTINE   = 
  = READS UNTIL CR            = .  ============================= 9 RL$"" Z  51340:  GET A SINGLE BYTE   C10  51450        :  IGNORE LF   C13         :  CR ENDS LINE   C20  (RL$)0  51520:  HANDVE ERROR MESSAGE AND NUMBER +S$"DISK ERR "(EN)":"EM$:  SEND ERROR ACROSS MODEM @ 50340:  50730 H< 2 QF 15 WP {d ============================= n = RECEIVE SINGLE BYTE       = x = WAITS UNTIL RX READY      =  ========, 1 STOP BIT ) CM,9 :  DTR ACTIVE (ONLINE), RX ENABLED, TX INTERRUPTS OFF )) 52450:  GET CD STATUS /) S) ============================= w) = FLUSH RX BUFFER SUBROUTINE= ) = WAITS UNTIL 50 READS IN A = ) = ROW DETECT NO WAITING DA1,T2  2,8,2,F$",S,R":  OPEN THE FILE AS SEQ, READ M CHECK DRIVE STATUS AFTER OPEN (CATCHES FILE NOT FOUND) b15,EN,EM$,T1,T2  EN0  51190:  SOMETHING WRONG, EXIT  =====MAIN READ LOOP ===== #2,A$  ST 0  51150 B&S$"ATH" & 50340:  50730 	'*DL.25: 52950:  A BIT OF A DELAY &'4 SR,0:  RESET THE 6551 M'>DL.25: 52950:  A BIT OF A DELAY 'H CR,31 :  38400 BAUD, 8 DATA BITS, 1 STOP BIT 'RDL.25: 52950:  A BIT OF A DELAY '\ CM,9 :  DTR ACTIH TIME, GO BACK   DR,B:  PUT THE BYTE INTO THE DATA REG /:  GO BACK T ============================== y = SEND CR/LF                 =   ============================== *B13:  50540:B10:  50540 4 p ===============XS$"ATA":  50340 $l 50730:  SEND CR/LF %qCD(SR)  64 %v /% ============================= S% = WAIT FOR CARRIER DETECT   = w% ============================= %CD(SR)  64 % CD 0  51880 % % ========================= "TX TIMEOUT SR=";A  50470  DR,B:  SEND THE BYTE ; --- END INLINE SEND --- C& I `0:  STRING SENT, RETURN D ============================== N = SEND A SINGLE BYTE         = X = PUT BYTE TO SEND IN B      = b ========Y BUFFER TO HOLD INCOMING DATA #A(SR): LOOK AT THE STATUS REGISTER E# (A  8)0  51690 :  = BIT 3 LOW READ AGAIN j#C(DR): READ THE DATA REGISTER # C10  51690:  IGNORE LINE FEED # C13  51780:  CR MARKS EOL # C32  C126  READ AND DISCARD IT *VQ0:  RESET THE EMPTY DATA COUNTER +` 52280:  GO READ IT AGAIN 7+j NO DATA DETECTED THIS LOOP k+tQQ1: ".";: INCREMENT OUR EMPTY DTAT COUNTER +~ Q50  52280:  LESS THAN 50 EMPTY READS?  DO IT AGAIN + ""::  WLE BACKSPACE ! C32  C126  51450:  NOT A NUMBER OR LETTER E!" (RL$)39  RL$RL$(C): EC1  BC:  50540 Y!, (RL$)40   e!6 51450 !@RL$(RL$,(RL$) 1):  EC1  BC: 50540 !J 51450 ! ============================ ! =  ===================== A(SR):C0 ) 52450: CD64  :  CHECK FOR CARRIER DROP e (A  8)0  51340: WAIT FOR A BYTE IN RECEIVE BUFFER C(DR): PRINT C:REM GET IT AND PUT IT INTO C   =============================  = RECEI	TA= ) = THEN ASSUMES THE BUFFER   = * = IS CLEAR                  = +*$ ============================= I*.Q0:  EMPTY DATA COUNTER l*8A(SR):  READ THE STATUS REG *B (A  8)0  52340:   IF DATA IS WAITING *LD(DR):  BYTE WAITING SO(A$) T00 A(SR) 
  (A  16)0  50990 '"T0T01:  T020  50974 3$ 50950 >. DR,B ]B 50950: GET ANOTHER BYTE ~ ==== EOF OR READ DONE ====  2:  15:   ==== ERROR PATH ==== 
 "DISK ERR ";EN;":";EM$:  PRINT DRIVE (ONLINE), RX ENABLED, TX INTERRUPTS OFF (a 52450:  GET CD STATUS (f 1( ============================= U( = SET/REST MODEM            = y( ============================= ( SR,0:  RESET THE 6551 ( CR,31 :  38400 BAUD, 8 DATA BITS============== z = SEND DISK FILE OVER MODEM = 0 = F$ = FILENAME             = T = SENDS LINES, CR/LF EACH   = x = REPORTS DISK ERRORS       =  =============================  15,8,15:  OPEN DISK COMMAND CHANNEL 15,EN,EM$,T==== % = HANGUP!                   = & ============================= 5&DL1: 52950:  A BIT OF A DELAY Y&S$"GOODBYE!":  50340:  50730 o&B("+"):  50540 &B("+"):  50540 &B("+"):  50540 &DL1: 52950:  A BIT OF A DELAY ====================== lT00:  A TIMEOUT COUNTER ?vA(SR) :   LOOK IN THE STATUS REGISTER s (A  16)0  50610:  IF TX EMPTY GO SEND IT T0T01:  TX WAS BUSY, ADD 1 TO TIMEOUT  T020  50550  "TX TIMEOUT SR=";A: TOOK TOO MUC 51690:  IS IT A LETTER? $& (L$)20  L$L$(C):  ADD IT TO L$ .$0 51690:  GO GET MORE DATA g$: IF WE BUILD THE STRING "RING" WE HAVE A CONNECTION $D L$"RING"  L$"RING"  51800 $N 51680:  SOMETHING ELSE  EMPTY IT AND DO IT AGAIN $E REACHED 50 EMPTY READS, EXIT + ============================= , = GET CARRIER STATUS        = B, = 64 - NO CARRIER           = f, = 0 - CARRIER               = , ============================= ,CD(SR)  64:  CHECK BIT 6 , ,WAIT FOR "RING" SUB      = 	" = WAITS FOR BIT 3 OF THE SR= ," = TO GO HIGH INDICATING THE= O" = RX LINE HAS RECEIVED DATA= r" = BUILDS A STR LOOKING FOR = " = "RING"                   = " ============================ "L$"":  EMPT
                                                                                                                                                                                                                                                      :                                                                                 (
   =============================== O   = BASIC U64 MODEM TEST        = v   = BY DAVID CULP               = (   = CODINGWITHCULP@GMAIL.COM    = 2   = YOUTUBE: @CODINGWITHCULP    = <   = @CODINGWITHCULP.BSKY.SOCIAL = 	F   = X @DWCULP  = S$: STRING TO OUTPUT        = D
  = RL$: RECEIVE LINE STRING    = j
  = C: CHARATER VALUE FOR IN    = 
  = B: BYTE FOR OUTPUT          = 
  = CD: CARRIER, 64=NO, 0=YES   = 
  = EC: LOCAL ECHO, 1=YES       =   = TT: 1/C64,2/ASCII, 3/ IN B - 50540      = 2 = SEND CR/LF - 50730          = X = SEND FILE IN F$ - 50870     = ~ = RECEIVE BYTE - 51340        = " = RECEIVE LINE - 51440        = , = WAIT FOR RING - 51680       = 6 = WAIT FOR CARRIER - 51880    = @     =   =============================== F =============================== l = SETUP 6551 AND COM VARIABLES=  =============================== BA56832:  $DE00 BASE ACIA REG DRBA :  DATA REGISTER SRBA1: STATUS REG CM 53281,0 : 646,1 = (147):"===================": "ULTIMATE MODEM TEST" X"==================="  "FLUSHING INPUT BUFFER:": 52270  52530 $ "WAITING FOR INCOMING CALL:" . 51680:  WAIT FOR RING 8 === WE HAVE A CONNECTION == 0340: 50730 	oDL3: 52950 0t "WAITING FOR THE BACKSPACE KEY." N~ 52730:  GET BS ROUTINE  TT1   "WE ONLY SUPPORT COMMODORE SYSTEMS!":  50340:  50730: 49000 DL3: 52950:B147: 50540 S$"WELCOME TO THE  LIGHTNING EXPRESS!!! -S$RL$" GLAD YOU ARE HERE!  THATS ALL WE HAVE FOR NOW!": 50340 >DL3: 52950 rh "HANGING UP!": 51930: 480:  GO BACK TO TOP P ============================= Z = PHONE RING SOUND (SID)    = d ============================= n R RING ON/OFF TWICE  R1  2 5 54276,65   :  PULSE + GATE ON  (64+1) J T1  250:  T o 54276,64   :  PULSE, GATE OFF  T1  200:  T  R " SILENCE , 54296,0 6 | ==============================  = SEND A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = 9	P   = VARIABLES USED:             = `	Z   = 6551 REGS                   = 	d  = BA: BASE ADDRESS            = 	n  = DR: DATA REGISTER           = 	x  = CM: COMMAND REGISTER        = 	  = CR: CONTROL REGISTER        = 
VT100  = (  = PA: PETSCII 1=TRUE          = N  = CO: COLUMNS 40=DEFAULT      = t  ===============================   = SUBROUTINE LINE #'S         =   = RING SOUND - 50030          =   = SEND STRING IN S$ - 50340   =   = SEND BYTE = HANGUP - 51930              = <J = SET/RESET MODEM - 52130     = bT = FLUSH RX BUFFER - 52270     = ^ = CHECK CARRIER - 52450       = h = PRINT 6551 REGS - 52530     = r = GET BS KEY CODE - 52730     = | = DELAY           - 52950BA2:  COMMAND REGISTER +CRBA3:  CONTROL REGISTER J 52130:  RESET THE MODEM oEC1: PA1:TT1:CO40:  ECHO ON  ==============================  =  BEGIN USERCODE HERE       =  ==============================  53280,0 : B "WE HAVE A CONNECTION!!":  50300 0L "SENDING INTRO TEXT" pVB147: 50540:B14:  50540:  CLEAR SCREEN, LOWERCASE MODE `S$"WELCOME TO THE ULTIMATE COMMODORE 64!":  50340: 50730 jS$"ARE YOU KEEPING UP WITH THE COMMODORE?": 5":  50340: 50730 DL4: 52950 JS$"HOW ABOUT WE READ A FILE FROM DISK?": 50340: 50730 jF$"STORM": 50870:  50540 S$"THESE ARE NOT THE DROIDS YOU ARE LOOKING FOR!": 50340: 50730 S$"WHAT IS YOUR NAME? ": 50340: 51440:  50730	ESET SID + SET VOLUME x I54272  54296:  I,0:  I : 54296,15:  MAX VOLUME R VOICE 1 FREQUENCY k 54272,0:  54273,8  PULSE WIDTH 50%  54274,0:  54275,8  ENVELOPE (FAST ATTACK, MEDIUM RELEASE)  54277,0:  54278,240  STRING SUBROUTINE   =  = PUT STRING TO SEND IN S$   = B ============================== OLN(S$) ^ I1  LN qB((S$,I,1)) T00:  TIMEOUT A(SR)  (A  16)0  50450:  CLEAR TO SEND T0T01  T020  50390                                                                                                                                                                                                                                     A W_        2A                                                                                      STORM            SWIFT         +                                                                                                                                                                                                 KK                                                                                                                                                                                                                                              KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK